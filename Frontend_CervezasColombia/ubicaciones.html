<!DOCTYPE html>
<html>
<head>
    <title>Ubicaciones - Cervezas Colombia</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script>
        // Variable para almacenar la URL del backend
        var backendUrl;

        // Obtener la dirección IP pública de la instancia desde el archivo public_ip.txt
        fetch('public_ip.txt')
            .then(response => response.text())
            .then(backendIp => {
                // Construir la URL del backend utilizando la dirección IP extraída
                backendUrl = `http://${backendIp}:7024/api/ubicaciones`;
            })
            .catch(error => {
                console.error('Error al leer public_ip.txt:', error);
            });

        // Esta función realiza una solicitud GET al endpoint del backend y actualiza los elementos HTML
        function obtenerDatosDesdeBackend() {
            // Verificar si la URL del backend está definida
            if (backendUrl) {
                fetch(backendUrl)
                    .then(response => response.json())
                    .then(data => {
                        // Actualiza los elementos HTML con los datos obtenidos
                        document.getElementById('ubicaciones-table-body').innerHTML = '';
                        data.forEach(ubicacion => {
                            const row = document.createElement('tr');
                            row.innerHTML = `<td>${ubicacion.id}</td>
                                             <td>${ubicacion.municipio}</td>
                                             <td>${ubicacion.departamento}</td>
                                             <td>${ubicacion.latitud}</td>
                                             <td>${ubicacion.longitud}</td>`;
                            document.getElementById('ubicaciones-table-body').appendChild(row);
                        });
                    })
                    .catch(error => {
                        console.error('Error al obtener datos desde el backend:', error);
                    });
            } else {
                console.error('La URL del backend no está definida. Verifica el contenido de public_ip.txt.');
            }
        }

        // Llama a la función para obtener datos cuando la página se carga
        document.addEventListener('DOMContentLoaded', obtenerDatosDesdeBackend);
    </script>
</head>
<body>
    <div class="ubicaciones-container ubicaciones-page">
        <div class="random-container">
            <div class="title-box">
                <h1>Ubicaciones</h1>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Municipio</th>
                            <th>Departamento</th>
                            <th>Latitud</th>
                            <th>Longitud</th>
                        </tr>
                    </thead>
                    <tbody id="ubicaciones-table-body">
                        <!-- Aquí se insertarán las filas de la tabla -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
